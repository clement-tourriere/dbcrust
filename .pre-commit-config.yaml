repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-merge-conflict
      - id: check-toml
      - id: check-yaml

  - repo: https://github.com/commitizen-tools/commitizen
    rev: v4.7.0
    hooks:
      - id: commitizen
      - id: commitizen-branch
        stages: [ pre-push ]

  - repo: local
    hooks:
      - id: cargo-fmt
        name: cargo fmt
        entry: cargo fmt
        language: system
        types: [rust]
        pass_filenames: false
        exclude: ^python/

      - id: cargo-clippy
        name: cargo clippy (focused on critical issues)
        entry: cargo clippy
        language: system
        types: [rust]
        pass_filenames: false
        # Focus on critical issues: correctness, performance, potential bugs
        # Allow style preferences and architectural choices
        args: [
          --lib, --bins, --,
          -D, "clippy::correctness",
          -D, "clippy::suspicious",
          -D, "clippy::perf",
          -W, "clippy::style",
          -W, "clippy::complexity",
          -A, "clippy::await_holding_lock",           # Architectural issue requiring major changes (TODO: migrate to tokio::sync::Mutex)
          -A, "clippy::needless_return",              # Style preference
          -A, "clippy::too_many_arguments",           # Architectural choice
          -A, "clippy::type_complexity",              # Complex types often necessary
          -A, "clippy::collapsible_if",               # Style preference - often clearer when not collapsed
          -A, "clippy::only_used_in_recursion",       # Common pattern in recursive functions (9 remaining)
          -A, "clippy::should_implement_trait",       # from_str pattern is clearer than FromStr trait sometimes
          -A, "clippy::enum_variant_names",           # Enum variant postfix naming is intentional (PowerShell brand name)
        ]
        exclude: ^(python/|tests/)
