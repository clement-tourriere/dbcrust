repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-merge-conflict
      - id: check-toml
      - id: check-yaml

  - repo: https://github.com/commitizen-tools/commitizen
    rev: v4.7.0
    hooks:
      - id: commitizen
      - id: commitizen-branch
        stages: [ pre-push ]

  - repo: local
    hooks:
      - id: cargo-fmt
        name: cargo fmt
        entry: cargo fmt
        language: system
        types: [rust]
        pass_filenames: false
        exclude: ^python/

      - id: cargo-clippy
        name: cargo clippy (focused on critical issues)
        entry: cargo clippy
        language: system
        types: [rust]
        pass_filenames: false
        # Focus on critical issues: correctness, performance, potential bugs
        # Allow style preferences and architectural choices
        args: [
          --lib, --bins, --,
          -D, "clippy::correctness",
          -D, "clippy::suspicious",
          -D, "clippy::perf",
          -W, "clippy::style",
          -W, "clippy::complexity",
          -A, "clippy::await_holding_lock",           # Architectural issue requiring major changes
          -A, "clippy::uninlined_format_args",        # Style preference
          -A, "clippy::useless_format",               # Style preference
          -A, "clippy::needless_return",              # Style preference
          -A, "clippy::field_reassign_with_default",  # Style preference
          -A, "clippy::derivable_impls",              # Style preference
          -A, "clippy::too_many_arguments",           # Architectural choice
          -A, "clippy::borrowed_box",                 # Trait object pattern
          -A, "clippy::type_complexity",              # Complex types often necessary
          -A, "clippy::items_after_test_module",      # Module organization preference
          -A, "clippy::single_char_add_str",          # Style preference
          -A, "clippy::option_as_ref_deref",          # Style preference
          -A, "clippy::redundant_closure",            # Sometimes clearer intent
          -A, "clippy::manual_range_contains",        # Style preference
          -A, "clippy::empty_line_after_doc_comments" # Style preference
        ]
        exclude: ^(python/|tests/)
